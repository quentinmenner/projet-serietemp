---
title: "Projet séries temporelles linéaires"
author: Antoine Joubrel et Quentin Menner
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document:
    toc: true
    toc_depth: 2
geometry: left=1.5cm,right=1.5cm,top=2cm,bottom=2cm
classoption: landscape
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(patchwork)
```

##  Partie I : Les données

### Question 1

La série étudiée représente la production mensuelle de biens manufacturés en France métropolitaine entre janvier 1985 et janvier 2000. C'est une série agrégée corrigée des variations saisonnières et des jours ouvrés (CVS-CJO) contenant 181 observations. L'unité de mesure est un indice de base 100 en 1990.
La série est de la forme suivante :

### Question 2

a) Nous sommes d'abord demandés si la série avait une saisonnalité. En observant attentivement année après année, on pourrait croire que la série est globalement croissante sur une année. Pour en avoir le coeur nette, nous avons regardé la répartition de l'indice pour chaque mois.

```{r, include=TRUE, echo=FALSE}
lien_graph = "Graphiques"
gg3 = readRDS(file.path(lien_graph,"boxplot.rds"))
plot(gg3)

```

Aucune saisonnalité semble se dégager.

b) Toutefois la série possède une tendance nette à la hausse malgré une baisse de l'indice entre 1990 et 1994. 

```{r, include=TRUE, echo=FALSE}
lien_graph = "Graphiques"
gg = readRDS(file.path(lien_graph,"courbe.rds"))
plot(gg)

```

Elle est nette quand on réalise une régression linéaire de la série sur le temps (coefficent de 0.087).

Nous avons donc différencié la série puis réaliser des tests de stationnarité sur cette nouvelle série.

Les test ADF et PP rejète l'hypothèse de racine unité et le test KPSS ne rejette pas l'hypothèse de stationnarité de la série. Nous considérons donc la série différenciée statinnaire.

### Question 3

```{r, include=TRUE, echo=FALSE}
lien_graph = "Graphiques"
gg = readRDS(file.path(lien_graph,"courbe.rds"))
gg_diff = readRDS(file.path(lien_graph,"ts_choisie.rds"))

gg

gg_diff
```

## Partie II : Modèles ARMA

### Question 4

Une autre caractéristique importante de notre série temporelle est son autocorrélation des résidues. On observe en effet qu'ils sont parfaitement linéairement décroissants et en dehors des intervalles de confiance. Cela nous amène penser que la série est une marche aléatoire.

```{r, include=TRUE, echo=FALSE}

acf1 = readRDS(file.path(lien_graph,"ACF_1.rds"))
plot(acf1)

```

5.

## Partie III : Prévision

6. Comme nous avons réalisé une différentiation d'un mois à l'autre dans la question 2, nous prenons ici le modèle de la forme ARIMA(1,1,0) :
\begin{center}
$Y_{t} = X_{t}-X_{t-1} = a + bY_{t-1} + \epsilon_{t}$
\end{center}
Avec $(\epsilon_{t})_{t} \sim {\sf Norm}(0,1)$. Avec une probabilité de $\alpha\%$, $\mid\epsilon_{t}\mid \leq q_{1-\frac{\alpha}{2}}$. Ce qui donne :

\begin{align*}
q_{\frac{\alpha}{2}} + a + bY_{T} \leq &Y_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + bY_{T} \\
q_{\frac{\alpha}{2}} + a + b(X_{T}-X_{T-1}) + X_{T} \leq &X_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + b(X_{T}-X_{T-1}) + X_{T} \\
q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1} \leq &X_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1} \\

\text{Et :          } q_{\frac{\alpha}{2}} + a + bY_{T+1} \leq &Y_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + bY_{T+1} \\
q_{\frac{\alpha}{2}} + a + (b+1)X_{T+1} - bX_{T} + \leq &X_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T+1} - bX_{T} \\
q_{\frac{\alpha}{2}} + a + (b+1)(q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}) - bX_{T} + \leq &X_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)(q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}) - bX_{T} \\
(b+2)q_{\frac{\alpha}{2}} + (b+2)a + (b^2 + b + 1)X_{T} - b(b+1)X_{T-1} \leq &X_{T+2} \leq (b+2)q_{1-\frac{\alpha}{2}} + (b+2)a + (b^2 + b + 1)X_{T} - b(b+1)X_{T-1} \\
\end{align*}

+D'après la partie II, $a = .. et b = ...$. Donc on a comme région de confiance de niveau $\alpha$:

$X_{T+1} \in \left[q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}, q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}\right]$

$X_{T+2} \in \left[..q_{\frac{\alpha}{2}} + .. + ..X_{T} - ..X_{T-1}, ..q_{1-\frac{\alpha}{2}} + .. + ..X_{T} - ..X_{T-1}\right]$

7. Pour obtenir cette région de confiance, nous utilisons les hypothèses que les résidus suivent une loi normale centrée réduite, que la série temporelle est considérée comme stationnaire une fois la différenciation effectuée et qu'elle peut être modélisée par un modèle ARIMA de paramètres (1,1,0)

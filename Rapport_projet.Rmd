---
title: "Projet séries temporelles linéaires"
output:
  pdf_document:
    toc: true
    toc_depth: 2
  word_document: default
  html_document:
    df_print: paged
geometry: left=1.5cm,right=1.5cm,top=2cm,bottom=2cm
classoption: landscape
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Packages utilisés ####
library(zoo)
library(tseries)
library(lmtest)
library(forecast)
library(ggplot2)
library(urca)
library(tidyverse)
library(lubridate)
library(xts)
library(patchwork)

# Chemin d'exportation graphiques
#setwd(dir = "~/projet-serietemp")
lien_graph = "projet-serietemp/Graphiques"

# Importation et structuration des données ####
datafile <- "valeurs_mensuelles_2.csv"
data <- read.csv(datafile, sep = ";") %>% 
  arrange(Periode) %>% 
  mutate(Periode = ym(Periode))
ts_data <- ts(data$Valeur, start = c(1985,01), freq = 12)
gg = ggplot(data = data, aes(x = Periode, y = Valeur))+
  geom_line()+
  scale_x_date(expand = c(0.01, 0.01)) +
  ggtitle("Evolution du prix de ... entre janvier 1985 et janvier 2000")+
  labs(caption = "Indice 100 en ...")+
  ggthemes::theme_stata()+
  theme(
    plot.title   = element_text(lineheight = 0.8, face = "bold", hjust = 0.5, size = 15),
    axis.text.x  = element_text(angle = 45, hjust = 1),
    axis.text.y  = element_text(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank())

saveRDS(gg, file.path(lien_graph,"courbe.rds"))
```


## Partie I : Les données

1. La série étudiée représente la production mensuelle de biens manufacturés en France métropolitaine entre janvier 1985 et janvier 2000. C'est une série agrégée corrigée des variations saisonnières et des jours ouvrés (CVS-CJO) contenant 181 observations. L'unité de mesure est un indice de base 100 en 1990.
La série est de la forme suivante : 

2.

3.

```{r cars}
summary(cars)
```

## Partie II : Modèles ARMA

4.


5.

```{r pressure, echo=FALSE}
plot(pressure)
```

## Partie III : Prévision

6. Comme nous avons réalisé une différentiation d'un mois à l'autre dans la question 2, nous prenons ici le modèle de la forme ARIMA(1,1,0) :
\begin{center}
$Y_{t} = X_{t}-X_{t-1} = a + bY_{t-1} + \epsilon_{t}$
\end{center}
Avec $(\epsilon_{t})_{t} \sim {\sf Norm}(0,1)$. Avec une probabilité de $\alpha\%$, $\mid\epsilon_{t}\mid \leq q_{1-\frac{\alpha}{2}}$. Ce qui donne :

\begin{align*}
q_{\frac{\alpha}{2}} + a + bY_{T} \leq &Y_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + bY_{T} \\
q_{\frac{\alpha}{2}} + a + b(X_{T}-X_{T-1}) + X_{T} \leq &X_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + b(X_{T}-X_{T-1}) + X_{T} \\
q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1} \leq &X_{T+1} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1} \\
\text{Et :          } q_{\frac{\alpha}{2}} + a + bY_{T+1} \leq &Y_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + bY_{T+1} \\
q_{\frac{\alpha}{2}} + a + (b+1)X_{T+1} - bX_{T} + \leq &X_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T+1} - bX_{T} \\
q_{\frac{\alpha}{2}} + a + (b+1)(q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}) - bX_{T} + \leq &X_{T+2} \leq q_{1-\frac{\alpha}{2}} + a + (b+1)(q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}) - bX_{T} \\
(b+2)q_{\frac{\alpha}{2}} + (b+2)a + (b^2 + b + 1)X_{T} - b(b+1)X_{T-1} \leq &X_{T+2} \leq (b+2)q_{1-\frac{\alpha}{2}} + (b+2)a + (b^2 + b + 1)X_{T} - b(b+1)X_{T-1} \\
\end{align*}

D'après la partie II, $a = .. et b = ...$. Donc on a comme région de confiance de niveau $\alpha$:

$X_{T+1} \in \left[q_{\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}, q_{1-\frac{\alpha}{2}} + a + (b+1)X_{T} - bX_{T-1}\right]$

$X_{T+2} \in \left[..q_{\frac{\alpha}{2}} + .. + ..X_{T} - ..X_{T-1}, ..q_{1-\frac{\alpha}{2}} + .. + ..X_{T} - ..X_{T-1}\right]$

7. Pour obtenir cette région de confiance, nous utilisons les hypothèses que les résidus suivent une loi normale centrée réduite, que la série temporelle est considérée comme stationnaire une fois la différenciation effectuée et qu'elle peut être modélisée par un modèle ARIMA de paramètres (1,1,0).

8.

9.
